<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="720" viewBox="0 0 1200 720">
  <defs>
    <style>
      .label { font-family: Helvetica, Arial, sans-serif; font-size: 16px; fill: #1d2a33; }
      .note { font-family: Helvetica, Arial, sans-serif; font-size: 13px; fill: #3b4a55; }
      .title { font-family: Helvetica, Arial, sans-serif; font-size: 20px; font-weight: 700; fill: #1d2a33; }
      .lifeline { stroke: #6b7b88; stroke-width: 2; stroke-dasharray: 6 6; }
      .actor { fill: #eef4f8; stroke: #1d2a33; stroke-width: 2; rx: 8; ry: 8; }
      .msg { stroke: #1d2a33; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .msg-back { stroke: #1d2a33; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .transcript { fill: #f7f9fb; stroke: #1d2a33; stroke-width: 1.5; rx: 8; ry: 8; }
    </style>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#1d2a33"/>
    </marker>
  </defs>

  <text x="40" y="40" class="title">Handshake Message Sequence (Transcript-Bound)</text>

  <rect x="120" y="70" width="220" height="50" class="actor"/>
  <text x="150" y="102" class="label">Initiator</text>

  <rect x="860" y="70" width="220" height="50" class="actor"/>
  <text x="905" y="102" class="label">Responder</text>

  <line x1="230" y1="120" x2="230" y2="650" class="lifeline"/>
  <line x1="970" y1="120" x2="970" y2="650" class="lifeline"/>

  <path d="M 250 170 L 950 170" class="msg"/>
  <text x="270" y="160" class="label">MessageA</text>
  <text x="270" y="184" class="note">version, supportedSuites[], policy, keyShares[], nonces</text>
  <text x="270" y="202" class="note">sigA, identityPubKey, seSigA (opt)</text>

  <path d="M 950 260 L 250 260" class="msg-back"/>
  <text x="270" y="250" class="label">MessageB</text>
  <text x="270" y="274" class="note">selectedSuite, responderShare, nonce, encrypted payload</text>
  <text x="270" y="292" class="note">sigB, identityPubKey, seSigB (opt)</text>

  <path d="M 950 360 L 250 360" class="msg-back"/>
  <text x="270" y="350" class="label">Finished_R2I</text>
  <text x="270" y="374" class="note">HMAC(finishedKey_R, transcriptHash)</text>

  <path d="M 250 450 L 950 450" class="msg"/>
  <text x="270" y="440" class="label">Finished_I2R</text>
  <text x="270" y="464" class="note">HMAC(finishedKey_I, transcriptHash)</text>

  <rect x="420" y="520" width="360" height="110" class="transcript"/>
  <text x="440" y="548" class="label">Transcript Hash Coverage</text>
  <text x="440" y="572" class="note">MessageA || MessageB || Finished_R2I || Finished_I2R</text>
  <text x="440" y="592" class="note">Policy is wire-visible and auditable (in MessageA)</text>
</svg>
