<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="360" viewBox="0 0 1200 360">
  <style>
    .title { font: 22px sans-serif; font-weight: 700; fill: #111; }
    .case { font: 16px sans-serif; font-weight: 700; fill: #111; }
    .label { font: 13px sans-serif; fill: #111; }
    .box { fill: none; stroke-width: 2; }
    .attacker { stroke: #D9534F; }
    .state { stroke: #5BC0DE; }
    .policy { stroke: #5CB85C; }
    .event { stroke: #F0AD4E; }
    .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrow); }
  </style>
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="8" refX="8" refY="4" orient="auto">
      <polygon points="0,0 10,4 0,8" fill="#333" />
    </marker>
  </defs>

  <rect width="100%" height="100%" fill="#ffffff"/>
  <text x="40" y="40" class="title">Audit-Signal Event Traces</text>

  <!-- Case 1 -->
  <text x="40" y="90" class="case">Case 1: Drop/Timeout</text>
  <rect x="60" y="120" rx="8" ry="8" width="220" height="60" class="box attacker" />
  <text x="170" y="155" text-anchor="middle" class="label">Drop MessageB</text>

  <rect x="330" y="120" rx="8" ry="8" width="220" height="60" class="box state" />
  <text x="440" y="155" text-anchor="middle" class="label">Timeout fires</text>

  <rect x="600" y="120" rx="8" ry="8" width="260" height="60" class="box policy" />
  <text x="730" y="145" text-anchor="middle" class="label">Fallback blocked</text>
  <text x="730" y="165" text-anchor="middle" class="label">(timeout blacklist)</text>

  <rect x="920" y="120" rx="8" ry="8" width="220" height="60" class="box event" />
  <text x="1030" y="155" text-anchor="middle" class="label">handshakeFailed</text>

  <line x1="280" y1="150" x2="330" y2="150" class="arrow" />
  <line x1="550" y1="150" x2="600" y2="150" class="arrow" />
  <line x1="860" y1="150" x2="920" y2="150" class="arrow" />

  <!-- Legend -->
  <rect x="60" y="240" width="20" height="20" class="box attacker" />
  <text x="90" y="255" class="label">Attacker Action</text>

  <rect x="260" y="240" width="20" height="20" class="box state" />
  <text x="290" y="255" class="label">State Transition</text>

  <rect x="480" y="240" width="20" height="20" class="box policy" />
  <text x="510" y="255" class="label">Policy Gate</text>

  <rect x="660" y="240" width="20" height="20" class="box event" />
  <text x="690" y="255" class="label">Emitted Event</text>
</svg>
